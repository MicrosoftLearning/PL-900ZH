---
lab:
    title: '实验室：Power BI'
    module: '模块 5: Power BI 入门'
---

# 模块 5: Power BI 入门
## 实验室：Power BI

应用场景
========

贝洛斯学院 (Bellows College) 是一所教育机构，校园内有多座建筑。当前，校园访客被记录在纸质日记中。无法始终如一地捕获信息，也无法收集和分析有关整个校园的访问数据。 

校园管理部门希望对其访客登记系统进行现代化改造，在该系统中，由安全人员控制对建筑物的访问，并且所有访问都必须由其主持人预先登记和记录。

在整个课程中，你将生成应用程序并执行自动化，以使 Bellows College 的管理和安全人员可以管理和控制校园建筑的出入情况。 

在本实验室中，你将构建一个 Power BI 仪表板，以可视化方式显示有关校园访问的数据。

概要实验室步骤
======================

我们将按照以下步骤设计和创建 Power BI 仪表板：

-   连接到 Common Data Service 
-   转换数据以包括相关记录（查找）的用户友好描述
-   创建并发布一份包含各种可视化校园访问信息的报告
-   构建其他可视化的用户自然语言查询
-   构建移动视图


## 先决条件

* 完成实验室 1 - 数据建模

开始前要考虑的事项
-----------------------------------

-   报告的目标受众是谁？
-   受众将如何使用报告？典型的设备？位置？
-   你是否有足够的数据进行可视化？
-   可以使用哪些可能的特征来分析访问数据？

练习 \#1：创建 Power BI 报告 
===============================

**目标：** 在本练习中，你将基于 Common Data Service 数据库中的数据创建 Power BI 报告。

任务 \#1：准备数据
---------------------------

1.  找到贵组织 URL

    * 导航到位于 https://admin.powerplatform.com 的 Power Platform 管理中心
    * 在左侧导航页面中，选择“环境”，然后打开目标环境。
    * 右键单击 **“详细信息”** 面板上的 **“环境 URL”**，然后选择 **“复制链接地址”**。
2. 如果尚未安装 Power BI Desktop，请导航至 https://aka.ms/pbidesktopstore 以下载并安装 Power BI 应用。

3. 打开 Power BI Desktop，如果出现提示，请登录。

4. 选择 **“获取数据”**。

5. 选择左侧的 **“Power Platform”**，然后选择 **“Common Data Service”**，最后按 **“连接”**.

6. 将先前复制的环境 URL 粘贴到 **“服务器 URL”** 字段，然后按 **“确定”**。

7. 展开 **“实体”** 节点，选择 **“bc_Building”** 和 **“bc_Visit”** 实体，然后单击 **“加载”**。

8. 单击左侧垂直工具栏上的 **“模型”** 图标。

9. 拖动 **bc_Building** 表中的 **bc_buildingid** 列并将其放置到 **bc_Visit** 表中的 **bc_building** 列中 。这将在 Power BI 将能够用来显示相关数据的两个实体之间建立关系。

10. 选择左侧工具栏上的 **“报告”** 图标。

11. 展开 **“字段”** 面板中的 **bc_Visits** 节点。

12. 单击 **“bc_Visits”** 旁边的 **“...”**，然后选择 **“新建列”**。

13. 完成以下公式

    ```
    Column = RELATED(bc_Building[bc_name])
    ```

    然后按 Enter。这会将带有建筑名称的新字段添加到访问数据中。

14. 单击字段旁边的 **“...”**，然后选择 **“重命名”**。输入 **“建筑”** 作为字段名称。

15. 单击 **bc_visitid** 字段旁边的 **“...”**，并选择 **“重命名”**。输入 **“访问”** 作为字段名称。

16. 单击 **bc_scheduledstart** 字段旁边的 **“...”**，并选择 **“重命名”**。输入 **“开始”** 作为字段名称。

17. 按以下方法保存正在进行的工作：按下 **“文件 \| 保存”** 并输入你选择的文件名。

## 任务 2：创建图表和时间可视化

1. 按下 **“可视化效果”** 面板中的饼图图标以插入图表。
2. 拖动 **“建筑物”** 字段并将其放入 **“图例”** 框。
3. 拖动 **“访问”** 字段并将其放入 **“值”** 目标框。
4. 使用角柄调整饼图的大小，以便所有图表组件均可见。
5. 单击 Power BI 功能区上 **“新建视觉对象”**，如果尚未选中，请在 **“可视化效果”** 窗格中选择“堆积柱形图”。 
6. 拖动 **“访问”** 字段并将其放入 **“值”** 目标框。
7. 拖动 **“开始”** 字段并将其放入 **“轴”** 目标框。
8. 在“可视化效果”窗格中，单击 **“天”** 和 **“季度”** 旁边的 **“x”**，只保留轴的 **“年”** 和 **“月”** 总计。
9. 根据需要使用角句柄调整图表大小。
10. 测试报告交互性：
    * 在饼图上选择各种建筑切片，并观察时间报告上的变化。
    * 选择时间柱形图上的各种条形，并观察饼图报告中的变化。
    * 按以下方法向下钻取到月份级别：使用图标或 **“数据/钻取 \| 展开下一级”** 功能区命令。
11. 按以下方法保存正在进行的工作：按下 **“文件 \| 保存”**。

练习 2：创建 Power BI 仪表板
================================

## 任务 #1：发布 Power BI 报告

1. 按下功能区“主页”选项卡上的 **“发布”** 按钮。

2. 选择 **“我的工作区”** 作为目的地，然后按 **“选择”**。

3. 等待发布完成，然后单击 **“在 Power BI 中打开 \<name of your report\>.pbix”**。

## 任务 2：创建 Power BI 仪表板

1. 在上一步打开的网页中，单击顶部的 **“我的工作区”**。
2. 从项目列表中选择你的 **“报表”**。
3. 选择在菜单上 **“固定实时页面”**。根据布局，你可能需要按 **“...”** 以显示其他菜单项。
4. 在 **“固定到仪表板”** 提示上选择 **“新建仪表板”**。
5. 输入 **“校园管理”** 作为 **“仪表板名称”**， 然后按 **“固定活动页”**。
6. 选择顶部 **“我的工作区”**，然后选择 **“校园管理”** 仪表板。
7. 测试显示的饼图和条形图的交互性。

## 任务 3：使用自然语言添加可视化

1. 在 **“校园管理”** 仪表板中，选择顶部的 **“提出有关你数据的问题”**。
2. 输入问答区域中 **“按访问次数划分的建筑”**。将显示条形图。
3. 选择 **“固定视觉对象”**。
4. 选择 **“现有仪表板”**， 选择 **“校园管理”** 仪表板，然后按 **“固定”**。
5. 通过单击图表以向下钻取到“问答”来测试行为。
6. 单击 **“退出问答”**。

## 任务 #4：生成手机视图

1. 在仪表板中，选择 **“... \| 移动视图”**。
2. 根据需要重新排列图块。
3. 单击右上角的 **“电话视图”**，并将“视图”更改为 **“Web 视图”**。
4. 选择顶部的 **“我的工作区”**，然后选择你的 **“报表”**。
5. 选择 **“... \| 生成 QR 码”**。
6. 如果你拥有移动设备，请使用 iOS 和 Android 平台上均可用的 QR 扫描仪应用来扫描代码。如果出现提示，请登录你的帐户。
7. 在移动设备上导航和浏览报表。

# 挑战

* 仪表板和报告，包括校园和建筑物计划
* 报告并分析访问模式和趋势
* 逾期可视化
* 流式 Power BI，用于大型校园的近实时处理 
